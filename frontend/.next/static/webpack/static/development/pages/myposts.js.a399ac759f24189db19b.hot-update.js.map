{"version":3,"file":"static/webpack/static\\development\\pages\\myposts.js.a399ac759f24189db19b.hot-update.js","sources":["webpack:///./actions/auth.js","webpack:///./components/DisplayPostsComponent.js"],"sourcesContent":["import fetch from 'isomorphic-fetch';\nimport cookie from 'js-cookie';\nimport { API } from '../config';\n\nexport const signup = user => {\n    return fetch(`${API}/signup`, {\n        method: 'POST',\n        headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(user)\n    })\n        .then(response => {\n            return response.json();\n        })\n        .catch(err => console.log(err));\n};\n\nexport const signin = user => {\n    return fetch(`${API}/signin`, {\n        method: 'POST',\n        headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(user)\n    })\n        .then(response => {\n            return response.json();\n        })\n        .catch(err => console.log(err));\n};\n\nexport const signout = next => {\n    removeCookie('token');\n    removeLocalStorage('user');\n    next();\n\n    return fetch(`${API}/signout`, {\n        method: 'GET'\n    })\n        .then(response => {\n            console.log('signout success');\n        })\n        .catch(err => console.log(err));\n};\n\n// set cookie\nexport const setCookie = (key, value) => {\n    if (process.browser) {\n        cookie.set(key, value, {\n            expires: 1\n        });\n    }\n};\n\nexport const removeCookie = key => {\n    if (process.browser) {\n        cookie.remove(key, {\n            expires: 1\n        });\n    }\n};\n// get cookie\nexport const getCookie = key => {\n    if (process.browser) {\n        return cookie.get(key);\n    }\n};\n// localstorage\nexport const setLocalStorage = (key, value) => {\n    if (process.browser) {\n        localStorage.setItem(key, JSON.stringify(value));\n    }\n};\n\nexport const removeLocalStorage = key => {\n    if (process.browser) {\n        localStorage.removeItem(key);\n    }\n};\n// autheticate user by pass data to cookie and localstorage\nexport const authenticate = (data, next) => {\n    setCookie('token', data.token);\n    setLocalStorage('user', data.user);\n    next();\n};\n\nexport const removeBlog = (slug, token) => {\n    return fetch(`${API}/blog/${slug}`, {\n        method: 'DELETE',\n        headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`\n        }\n    })\n        .then(response => {\n            return response.json();\n        })\n        .catch(err => console.log(err));\n};\n\nexport const isAuth = () => {\n    if (process.browser) {\n        const cookieChecked = getCookie('token');\n        if (cookieChecked) {\n            if (localStorage.getItem('user')) {\n                return JSON.parse(localStorage.getItem('user'));\n            } else {\n                return false;\n            }\n        }\n    }\n};\n\nexport const singlePost = slug => {\n  return fetch(`${API}/post/${slug}`, {\n    method: 'GET'\n  })\n  .then(response => {\n    return response.json()\n  })\n  .catch(err => console.log(err))\n}\n","import {useState, useEffect} from 'react'\r\nimport axios from 'axios'\r\nimport {getCookie, isAuth, removeBlog } from '../actions/auth'\r\nimport Link from 'next/link'\r\n\r\nconst DisplayPostsComponent = () => {\r\n  const [posts, setPosts] = useState([])\r\n  const token = getCookie('token')\r\n\r\n  const fetchPosts = () => {\r\n    axios.get('http://localhost:8000/api/post', {\r\n      headers : {\r\n        authorization: `Bearer ${token}`\r\n      }\r\n    })\r\n    .then(response => {\r\n      console.log(response.data)\r\n      setPosts(response.data)\r\n    })\r\n    .catch(error => alert(error))\r\n  }\r\n\r\n  const deletePost = (slug) => {\r\n    removeBlog(slug, token).then(data => {\r\n      if(data.error) {\r\n        console.log(data.error)\r\n      } else {\r\n        setMessage(data.message)\r\n      }\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchPosts()\r\n  }, [])\r\n\r\n  return (\r\n    <div class=\"container\">\r\n      <div class=\"row\">\r\n        {posts.map((post,i) =>\r\n          <React.Fragment>\r\n            <div class=\"col-lg-8 col-md-8 col-sm-12\">\r\n              <div key={post._id}>\r\n                <Link href={`/post/${post.slug}`}><h1>{post.title}</h1></Link>\r\n                <p>{post.content.substring(0,100)}</p>\r\n                <p>published on: {new Date(post.createAt).toLocaleString()}</p>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-lg-4 col-md-4 col-sm-12\">\r\n              <Link href={`/post/update/${post.slug}`}><button class=\"btn btn-sm btn-outline-warning\">Update</button></Link>\r\n              <button onClick={deletePost()} class=\"btn btn-sm btn-outline-danger\">Delete</button>\r\n            </div>\r\n          </ React.Fragment>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default DisplayPostsComponent\r\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AANA;AASA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AANA;AASA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AADA;AAIA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AAGA;AACA;AAEA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AASA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AADA;AAIA;AACA;AACA;AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;AC7HA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AADA;AAMA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAXA;AAkBA;AACA;AACA;;;;A","sourceRoot":""}